<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>Real-time User Visualization App</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=t07wn09rng&callback=initMap"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: "hsl(var(--border))",
                        input: "hsl(var(--input))",
                        ring: "hsl(var(--ring))",
                        background: "hsl(var(--background))",
                        foreground: "hsl(var(--foreground))",
                        primary: { DEFAULT: "hsl(var(--primary))", foreground: "hsl(var(--primary-foreground))" },
                        secondary: { DEFAULT: "hsl(var(--secondary))", foreground: "hsl(var(--secondary-foreground))" },
                        muted: { DEFAULT: "hsl(var(--muted))", foreground: "hsl(var(--muted-foreground))" },
                        card: { DEFAULT: "hsl(var(--card))", foreground: "hsl(var(--card-foreground))" },
                        // [ìˆ˜ì •] í•«í”Œë ˆì´ìŠ¤ ë‹¨ê³„ë³„ ì»¬ëŸ¬ (ë” ì„ ëª…í•˜ê²Œ)
                        status: { 
                            blue: "#3b82f6",   // ì—¬ìœ 
                            green: "#22c55e",  // ë³´í†µ
                            orange: "#f97316", // í˜¼ì¡
                            red: "#ef4444"     // í¬í™”
                        }
                    },
                    borderRadius: { lg: "var(--radius)", md: "calc(var(--radius) - 2px)", sm: "calc(var(--radius) - 4px)" },
                    fontFamily: { sans: ['Pretendard', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        :root {
            --background: 0 0% 100%; --foreground: 222.2 84% 4.9%; --card: 0 0% 100%; --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%; --popover-foreground: 222.2 84% 4.9%; --primary: 222.2 47.4% 11.2%; --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%; --secondary-foreground: 222.2 47.4% 11.2%; --muted: 210 40% 96.1%; --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96.1%; --accent-foreground: 222.2 47.4% 11.2%; --destructive: 0 84.2% 60.2%; --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%; --input: 214.3 31.8% 91.4%; --ring: 222.2 84% 4.9%; --radius: 0.75rem; --sidebar-width: 400px;
        }
        body { font-family: 'Pretendard', sans-serif; overflow: hidden; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* ë§ˆì»¤ ìƒí˜¸ì‘ìš© */
        .marker-content { transition: z-index 0.2s; }
        .marker-content:hover { z-index: 100 !important; }
        .marker-bubble { transition: transform 0.2s; }
        .marker-content:hover .marker-bubble { transform: translateY(-5px) scale(1.05); }

        /* [ìˆ˜ì •] í•«í”Œ ë¬¼ê²° ì• ë‹ˆë©”ì´ì…˜ (CSS ë³€ìˆ˜ë¡œ í¬ê¸° ì¡°ì ˆ) */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 0.8; }
            100% { transform: scale(var(--pulse-scale)); opacity: 0; }
        }
        .hot-pulse::before {
            content: ''; position: absolute; left: 0; top: 0; width: 100%; height: 100%;
            border-radius: 50%; background-color: inherit; z-index: -1;
            animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }

        .modal-enter { opacity: 0; transform: translate(-50%, -45%) scale(0.95); }
        .modal-enter-active { opacity: 1; transform: translate(-50%, -50%) scale(1); transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .overlay-enter { opacity: 0; }
        .overlay-enter-active { opacity: 1; transition: opacity 0.3s; }
        
        /* ë²”ë¡€ ë„íŠ¸ ì»¬ëŸ¬ */
        .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; }
        .dot.blue { background-color: #3b82f6; }
        .dot.green { background-color: #22c55e; }
        .dot.orange { background-color: #f97316; }
        .dot.red { background-color: #ef4444; }

        .wheel-picker { display: flex; height: 160px; position: relative; overflow: hidden; mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent); -webkit-mask-image: linear-gradient(to bottom, transparent, black 20%, black 80%, transparent); }
        .wheel-col { flex: 1; overflow-y: auto; scroll-snap-type: y mandatory; padding: 64px 0; }
        .wheel-col::-webkit-scrollbar { display: none; }
        .wheel-item { height: 32px; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #9ca3af; scroll-snap-align: center; transition: color 0.2s; cursor: pointer; }
        .wheel-item.selected { color: #0f172a; font-weight: bold; font-size: 18px; }
        .wheel-highlight { position: absolute; top: 50%; left: 0; right: 0; height: 34px; transform: translateY(-50%); background: rgba(0,0,0,0.05); border-top: 1px solid rgba(0,0,0,0.1); border-bottom: 1px solid rgba(0,0,0,0.1); pointer-events: none; z-index: -1; }
    </style>
</head>
<body class="bg-background text-foreground w-screen h-screen relative">

    <div id="map" class="w-full h-full absolute top-0 left-0 z-0"></div>

    <div class="absolute top-5 left-5 z-10 md:left-[420px] bg-background/90 backdrop-blur-sm p-3 rounded-lg shadow-sm border border-border flex gap-3 text-xs font-semibold text-muted-foreground pointer-events-none">
        <div class="flex items-center gap-1.5"><span class="dot blue"></span>ì—¬ìœ </div>
        <div class="flex items-center gap-1.5"><span class="dot green"></span>ë³´í†µ</div>
        <div class="flex items-center gap-1.5"><span class="dot orange"></span>í˜¼ì¡</div>
        <div class="flex items-center gap-1.5"><span class="dot red"></span>í¬í™”</div>
    </div>

    <div class="pointer-events-none absolute inset-0 flex flex-col md:pointer-events-auto md:fixed md:w-[400px] md:border-r md:border-border md:bg-background md:shadow-xl md:z-40">
        
        <div id="top-panel" class="pointer-events-auto bg-background p-4 flex flex-col gap-3 border-b border-border shadow-sm md:shadow-none z-30 transition-transform duration-300">
            <div class="flex items-center bg-muted rounded-lg h-11 px-3 gap-2 transition-all hover:ring-1 hover:ring-ring/20">
                <i class="fa-solid fa-bars text-muted-foreground cursor-pointer hover:text-primary" onclick="openModal('mypage')"></i>
                <input type="text" id="search-input" class="flex-1 bg-transparent border-none outline-none text-sm font-medium text-foreground placeholder:text-muted-foreground" placeholder="ì§€ì—­, í•«í”Œ ê²€ìƒ‰" readonly>
                <i class="fa-solid fa-magnifying-glass text-primary cursor-pointer"></i>
            </div>

            <div class="flex items-center gap-2 w-full">
                <button id="btn-datetime" onclick="openModal('datetime')" class="flex-none flex items-center gap-2 bg-primary text-primary-foreground px-4 py-1.5 rounded-full text-xs font-bold shadow-sm transition-all hover:bg-primary/90 whitespace-nowrap">
                    <i class="fa-regular fa-calendar"></i> <span id="datetime-text">11.26(ìˆ˜) ì˜¤í›„ 6:30</span>
                </button>

                <div class="flex-1 flex gap-2 overflow-x-auto scrollbar-hide py-1" id="filter-container">
                    <button class="chip active px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap transition-all hover:bg-muted" onclick="filterPlaces('all')">ì „ì²´</button>
                    <button class="chip px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap hover:bg-muted transition-all" onclick="filterPlaces('cafe')">ì¹´í˜/ë””ì €íŠ¸</button>
                    <button class="chip px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap hover:bg-muted transition-all" onclick="filterPlaces('group')">ë‹¨ì²´ ëª¨ì„</button>
                    <button class="chip px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap hover:bg-muted transition-all" onclick="filterPlaces('mood')">ë¶„ìœ„ê¸° ì¢‹ì€</button>
                    <button class="chip px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap hover:bg-muted transition-all" onclick="filterPlaces('pub')">ìˆ ì§‘/ë°¥ì§‘</button>
                </div>
            </div>
        </div>

        <div class="pointer-events-auto bg-background flex flex-col absolute bottom-0 left-0 right-0 rounded-t-2xl shadow-[0_-4px_20px_rgba(0,0,0,0.1)] h-[45vh] md:static md:h-full md:rounded-none md:shadow-none z-20">
            <div class="w-full flex justify-center py-3 cursor-grab md:hidden">
                <div class="w-10 h-1 bg-muted-foreground/30 rounded-full"></div>
            </div>
            
            <div id="list-view" class="flex flex-col h-full w-full">
                <div class="px-5 py-3 flex items-center gap-3 text-xs text-muted-foreground border-b border-border bg-background/50 backdrop-blur shrink-0">
                    <span class="cursor-pointer text-primary font-bold">ğŸ”¥ ì‹¤ì‹œê°„ ì¶”ì²œìˆœ</span>
                    <span class="text-border">|</span>
                    <span class="cursor-pointer hover:text-primary transition-colors">ê±°ë¦¬ìˆœ</span>
                    <span class="text-border">|</span>
                    <span class="cursor-pointer hover:text-primary transition-colors">ë¦¬ë·° ë§ì€ìˆœ</span>
                </div>

                <div class="flex-1 overflow-y-auto scrollbar-hide p-0" id="place-list">
                    </div>
            </div>

            <div id="route-view" class="hidden flex-col h-full w-full bg-background">
                <div class="px-5 py-4 border-b border-border flex justify-between items-center shrink-0">
                    <h3 class="font-bold text-lg text-foreground flex items-center gap-2"><i class="fa-solid fa-route text-primary"></i> ê²½ë¡œ ì„ íƒ</h3>
                    <button onclick="stopNavigation()" class="px-3 py-1.5 bg-muted text-foreground text-xs font-bold rounded-lg hover:bg-muted/80 transition-colors">ì•ˆë‚´ ì¢…ë£Œ</button>
                </div>
                
                <div class="flex-1 overflow-y-auto p-4 flex flex-col gap-3">
                    <div class="route-card cursor-pointer p-4 rounded-xl border-2 border-status-blue bg-status-blue/5 hover:bg-status-blue/10 transition-all relative shadow-sm" onclick="highlightRoute(0)">
                        <div class="flex justify-between items-start mb-2">
                            <div class="font-bold text-base text-foreground">1. ìµœë‹¨ ê±°ë¦¬</div>
                            <span class="text-xs font-bold text-status-blue bg-white px-2 py-1 rounded-full border border-status-blue/20">ì¶”ì²œ</span>
                        </div>
                        <div class="flex items-center gap-4 text-sm text-muted-foreground">
                            <span class="font-bold text-foreground text-lg"><i class="fa-solid fa-person-walking mr-1"></i>8ë¶„</span>
                            <span>520m</span>
                        </div>
                    </div>
                    <div class="route-card cursor-pointer p-4 rounded-xl border border-status-green hover:border-status-green hover:bg-status-green/5 transition-all relative shadow-sm" onclick="highlightRoute(1)">
                        <div class="flex justify-between items-start mb-2">
                            <div class="font-bold text-base text-foreground">2. ë¶„ìœ„ê¸° ì¢‹ì€ ê²½ë¡œ</div>
                            <span class="text-xs text-status-green"><i class="fa-solid fa-camera"></i> ëŒë‹´ê¸¸ ê²½ìœ </span>
                        </div>
                        <div class="flex items-center gap-4 text-sm text-muted-foreground">
                            <span class="font-bold text-foreground text-lg"><i class="fa-solid fa-person-walking mr-1"></i>12ë¶„</span>
                            <span>650m</span>
                        </div>
                    </div>
                    <div class="route-card cursor-pointer p-4 rounded-xl border border-status-red hover:border-status-red hover:bg-status-red/5 transition-all relative shadow-sm" onclick="highlightRoute(2)">
                        <div class="flex justify-between items-start mb-2">
                            <div class="font-bold text-base text-status-red">3. ìš°ë²” ì§€ì—­ (ì£¼ì˜)</div>
                            <span class="text-xs text-status-red"><i class="fa-solid fa-triangle-exclamation"></i> ê°€ë¡œë“± ì—†ìŒ</span>
                        </div>
                        <div class="flex items-center gap-4 text-sm text-muted-foreground">
                            <span class="font-bold text-foreground text-lg"><i class="fa-solid fa-person-walking mr-1"></i>10ë¶„</span>
                            <span>580m</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="datetime-modal" class="modal-window fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-[320px] bg-background rounded-2xl shadow-2xl z-[70] hidden flex-col overflow-hidden transition-all duration-300 border border-border">
        <div class="flex justify-between items-center p-4 border-b border-border bg-muted/30">
            <h3 class="text-base font-bold text-primary">ë°©ë¬¸ ì¼ì‹œ ì„¤ì •</h3>
            <button class="text-muted-foreground hover:text-primary transition-colors" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="p-4 flex flex-col gap-4">
            <div class="flex flex-col gap-2">
                <div class="flex justify-between text-sm font-bold text-foreground px-1"><span>11ì›”</span><span>2025</span></div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs" id="calendar-grid"></div>
            </div>
            <div class="border-t border-border"></div>
            <div class="wheel-picker">
                <div class="wheel-highlight"></div>
                <div class="wheel-col" id="wheel-ampm"><div class="wheel-item" data-val="AM">ì˜¤ì „</div><div class="wheel-item selected" data-val="PM">ì˜¤í›„</div></div>
                <div class="wheel-col" id="wheel-hour"></div>
                <div class="wheel-col" id="wheel-minute"><div class="wheel-item" data-val="00">00ë¶„</div><div class="wheel-item selected" data-val="30">30ë¶„</div></div>
            </div>
            <button class="w-full py-3 bg-primary text-primary-foreground rounded-xl font-bold text-sm hover:bg-primary/90 transition-colors shadow-sm mt-2" onclick="confirmDateTime()">ì„¤ì • ì™„ë£Œ</button>
        </div>
    </div>

    <div id="keyword-modal" class="modal-window fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-[320px] bg-background rounded-2xl shadow-2xl z-[80] hidden flex-col overflow-hidden transition-all duration-300 border border-border">
        <div class="flex justify-between items-center p-4 border-b border-border bg-muted/30">
            <h3 class="text-base font-bold text-primary">í‚¤ì›Œë“œ ì¶”ê°€</h3>
            <button class="text-muted-foreground hover:text-primary transition-colors" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="p-4 flex flex-col gap-4">
            <div class="relative">
                <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm"></i>
                <input type="text" id="keyword-input" placeholder="ì·¨í–¥ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš” (ì˜ˆ: ë¶„ìœ„ê¸°)" class="w-full pl-9 pr-3 py-2.5 bg-muted/50 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20" oninput="onKeywordInput(this.value)">
            </div>
            <div>
                <p class="text-xs font-bold text-muted-foreground mb-2">ì¶”ì²œ í‚¤ì›Œë“œ</p>
                <div id="keyword-suggestions" class="flex flex-col gap-1 max-h-[200px] overflow-y-auto scrollbar-hide"></div>
            </div>
        </div>
    </div>

    <div id="modal-overlay" class="fixed inset-0 bg-black/40 z-50 hidden opacity-0 transition-opacity duration-300 backdrop-blur-[2px]" onclick="closeModal()"></div>
    <div id="detail-modal" class="modal-window fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-[380px] bg-background rounded-xl shadow-2xl z-[60] hidden flex-col max-h-[85vh] overflow-hidden transition-all duration-300"></div>
    <div id="reservation-modal" class="modal-window fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-[380px] bg-background rounded-xl shadow-2xl z-[60] hidden flex-col max-h-[85vh] overflow-hidden transition-all duration-300">
        <div class="flex justify-between items-center p-5 border-b border-border"><h3 class="text-lg font-bold text-primary">ë§¤ì¥ ì˜ˆì•½í•˜ê¸°</h3><button class="text-muted-foreground hover:text-primary transition-colors" onclick="closeModal()"><i class="fa-solid fa-xmark text-xl"></i></button></div>
        <div class="p-5 overflow-y-auto"><div class="flex flex-col gap-4"><div class="flex flex-col gap-1.5"><label class="text-sm font-medium text-muted-foreground">ë‚ ì§œ ì„ íƒ</label><input type="date" id="res-date" class="w-full p-2.5 bg-muted/50 border border-border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"></div><button class="w-full py-3 mt-2 bg-primary text-primary-foreground rounded-lg font-bold text-sm hover:bg-primary/90 transition-colors shadow-sm" onclick="submitReservation()">ì˜ˆì•½ í™•ì •í•˜ê¸°</button></div></div>
    </div>
    
    <div id="mypage-modal" class="modal-window fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[90%] max-w-[380px] bg-background rounded-xl shadow-2xl z-[60] hidden flex-col max-h-[85vh] overflow-hidden transition-all duration-300">
        <div class="flex justify-between items-center p-5 border-b border-border"><h3 class="text-lg font-bold text-primary">ë§ˆì´ í˜ì´ì§€</h3><button class="text-muted-foreground hover:text-primary transition-colors" onclick="closeModal()"><i class="fa-solid fa-xmark text-xl"></i></button></div>
        <div class="p-5 overflow-y-auto">
            <div class="flex border-b border-border mb-5">
                <div class="tab-item active flex-1 text-center pb-3 text-sm font-bold text-primary border-b-2 border-primary cursor-pointer" onclick="switchTab('profile', this)">ë‚´ ì •ë³´</div>
                <div class="tab-item flex-1 text-center pb-3 text-sm font-medium text-muted-foreground border-b-2 border-transparent cursor-pointer" onclick="switchTab('taste', this)">ë‚´ ì·¨í–¥</div>
                <div class="tab-item flex-1 text-center pb-3 text-sm font-medium text-muted-foreground border-b-2 border-transparent cursor-pointer" onclick="switchTab('stamps', this)">ìŠ¤íƒ¬í”„</div>
                <div class="tab-item flex-1 text-center pb-3 text-sm font-medium text-muted-foreground border-b-2 border-transparent cursor-pointer" onclick="switchTab('events', this)">ì´ë²¤íŠ¸</div>
            </div>
            
            <div id="tab-profile" class="tab-content block">
                <div class="text-center p-5 bg-muted/30 rounded-xl mb-6"><div class="w-16 h-16 bg-muted rounded-full flex items-center justify-center text-3xl mx-auto mb-3">ğŸ‘¤</div><h4 class="font-bold text-lg">ê¹€í•«í”Œ ë‹˜</h4></div>
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-2 px-1"><h5 class="text-sm font-bold text-foreground">í˜„ì¬ ì˜ˆì•½</h5><span class="text-xs text-primary cursor-pointer hover:underline">ì „ì²´ë³´ê¸°</span></div>
                    <div class="bg-card border border-primary/20 rounded-xl p-4 shadow-sm flex justify-between items-center relative overflow-hidden">
                        <div class="absolute left-0 top-0 bottom-0 w-1 bg-primary"></div>
                        <div><div class="font-bold text-sm text-foreground mb-1">ì‹¬ì•¼ì‹ë‹¹ ëª½í™˜</div><div class="text-xs text-muted-foreground flex gap-2 items-center"><span class="flex items-center gap-1"><i class="fa-regular fa-calendar"></i> ì˜¤ëŠ˜ 19:00</span><span class="w-px h-3 bg-border"></span><span class="flex items-center gap-1"><i class="fa-solid fa-user"></i> 2ëª…</span></div></div>
                        <div class="flex flex-col items-end gap-1"><span class="text-[10px] font-bold text-status-green bg-status-green/10 px-2 py-0.5 rounded-full border border-status-green/20">ë°©ë¬¸ ì˜ˆì •</span></div>
                    </div>
                </div>
                <div class="bg-card border border-border rounded-xl divide-y divide-border">
                    <div class="flex justify-between p-4 text-sm"><span class="text-muted-foreground">ìµœê·¼ ë°©ë¬¸</span> <span class="font-bold">3ê³³</span></div>
                    <div class="flex justify-between p-4 text-sm"><span class="text-muted-foreground">ì‘ì„± ë¦¬ë·°</span> <span class="font-bold">12ê°œ</span></div>
                </div>
            </div>
            
            <div id="tab-taste" class="tab-content hidden">
                <p class="text-xs text-muted-foreground mb-3">ê¹€í•«í”Œë‹˜ì´ ì„ í˜¸í•˜ëŠ” í‚¤ì›Œë“œì…ë‹ˆë‹¤.</p>
                <div class="flex flex-wrap gap-2 mb-5" id="taste-keyword-container"></div>
                <div class="bg-muted/30 p-4 rounded-xl border border-border"><p class="text-sm font-bold mb-1">ğŸ¯ ì¶”ì²œ ì¹´í…Œê³ ë¦¬</p><p class="text-xs text-muted-foreground">ìŠ¤í„°ë””í•˜ê¸° ì¢‹ì€ ì¡°ìš©í•œ ì¹´í˜, í˜¼ìˆ í•˜ê¸° ì¢‹ì€ ì´ìì¹´ì•¼</p></div>
            </div>

            <div id="tab-stamps" class="tab-content hidden">
                <div class="flex justify-between items-center mb-4"><h4 class="font-bold text-primary">â˜• í™ëŒ€ ì¹´í˜ íˆ¬ì–´</h4><span class="text-xs font-bold text-status-red bg-status-red/10 px-2 py-1 rounded">D-5</span></div>
                <div class="grid grid-cols-5 gap-3 mb-4">
                    <div class="aspect-square rounded-full bg-status-orange/20 border-2 border-status-orange flex items-center justify-center text-status-orange font-bold shadow-sm"><i class="fa-solid fa-check"></i></div>
                    <div class="aspect-square rounded-full bg-status-orange/20 border-2 border-status-orange flex items-center justify-center text-status-orange font-bold shadow-sm"><i class="fa-solid fa-check"></i></div>
                    <div class="aspect-square rounded-full bg-status-orange/20 border-2 border-status-orange flex items-center justify-center text-status-orange font-bold shadow-sm"><i class="fa-solid fa-check"></i></div>
                    <div class="aspect-square rounded-full bg-muted border border-border flex items-center justify-center text-muted-foreground font-bold text-xs">4</div>
                    <div class="aspect-square rounded-full bg-muted border border-border flex items-center justify-center text-muted-foreground font-bold text-xs">5</div>
                </div>
                <p class="text-xs text-center text-muted-foreground">2ê°œ ë” ëª¨ìœ¼ë©´ ì•„ë©”ë¦¬ì¹´ë…¸ ë¬´ë£Œ!</p>
            </div>

            <div id="tab-events" class="tab-content hidden">
                <div class="flex flex-col gap-3">
                    <div class="bg-card border border-border p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer">
                        <div class="font-bold text-sm mb-1 text-primary">ğŸ“¢ ì˜¤í”ˆ ê¸°ë… ë¦¬ë·° ì´ë²¤íŠ¸</div>
                        <div class="text-xs text-status-blue mb-2 font-medium">2023.10.01 ~ 10.31</div>
                        <p class="text-xs text-muted-foreground">ë¦¬ë·° ì‘ì„± ì‹œ í¬ì¸íŠ¸ 2ë°° ì ë¦½!</p>
                    </div>
                    <div class="bg-card border border-border p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow cursor-pointer">
                        <div class="font-bold text-sm mb-1 text-primary">â˜• ì œíœ´ ì¹´í˜ 10% í• ì¸</div>
                        <div class="text-xs text-status-green mb-2 font-medium">ìƒì‹œ ì§„í–‰</div>
                        <p class="text-xs text-muted-foreground">í•™ìƒì¦ ì¸ì¦ ì‹œ ëª¨ë“  ìŒë£Œ í• ì¸</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed top-[100px] left-1/2 -translate-x-1/2 bg-foreground/90 text-background px-4 py-2 rounded-full text-xs font-medium z-[100] opacity-0 transition-opacity pointer-events-none shadow-lg md:left-[calc(400px+50%)]"></div>

    <script>
        // --- [ìˆ˜ì •] ë°ì´í„°: 18ì‹œ ê¸°ì¤€ ëª¨ë“  ìƒíƒœ(íŒŒë‘/ì´ˆë¡/ì£¼í™©/ë¹¨ê°•)ê°€ ë‚˜ì˜¤ë„ë¡ ì¡°ì • ---
        const placesData = [
            { 
                name: "ì¹´í˜ ì˜¤ë¸Œì œ", category: "ì¹´í˜", lat: 37.5575, lng: 126.9245, 
                tags: ["#ê°ì„±", "#í¬í† ì¡´", "cafe", "mood"], 
                img: "https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=400&h=400&auto=format&fit=crop", 
                address: "ì™€ìš°ì‚°ë¡œ 21ê¸¸ 10", time: "12:00 - 22:00", desc: "ì•¤í‹°í¬í•œ ê°ì„± ì¹´í˜", 
                menu: { "ì•„ì¸ìŠˆí˜ë„ˆ": "6,500ì›", "í¬ë¡œí”Œ": "9,000ì›" }, 
                statusMap: { 12: {text:"ì—¬ìœ ", color:"blue"}, 18: {text:"ì—¬ìœ ", color:"blue"}, 22: {text:"ì˜ì—…ì¢…ë£Œ", color:"gray"} } 
            },
            { 
                name: "ë ˆë²¨ì—… PCì¹´í˜", category: "PCë°©", lat: 37.5568, lng: 126.9238, 
                tags: ["#RTX4090", "#ê³ ì‚¬ì–‘", "group"], 
                img: "https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=400&h=400&auto=format&fit=crop", 
                address: "í™ìµë¡œ 6ê¸¸ 10", time: "24ì‹œê°„", desc: "í”„ë¦¬ë¯¸ì—„ ì‚¬ì–‘ PCë°©", 
                menu: { "ì¹˜í‚¨ë§ˆìš”": "6,500ì›", "ì•„ë©”ë¦¬ì¹´ë…¸": "3,000ì›" }, 
                statusMap: { 12: {text:"ì—¬ìœ ", color:"blue"}, 18: {text:"ë³´í†µ", color:"green"}, 22: {text:"í¬í™”", color:"red"} } 
            },
            { 
                name: "ì‹¬ì•¼ì‹ë‹¹ ëª½í™˜", category: "ì´ìì¹´ì•¼", lat: 37.5582, lng: 126.9255, 
                tags: ["#ì¡°ìš©í•œ", "#í˜¼ìˆ ", "pub", "mood"], 
                img: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=400&h=400&auto=format&fit=crop", 
                address: "ì™€ìš°ì‚°ë¡œ 29ê¸¸ 12", time: "18:00 - 03:00", desc: "í˜¼ìˆ í•˜ê¸° ì¢‹ì€ ëª½í™˜ì ì¸ ë¶„ìœ„ê¸°", 
                menu: { "ëª¨ë“¬ ê¼¬ì¹˜": "15,000ì›", "ëª…ë€ êµ¬ì´": "12,000ì›" }, 
                statusMap: { 12: {text:"ì˜ì—…ì „", color:"gray"}, 18: {text:"í˜¼ì¡", color:"orange"}, 20: {text:"í˜¼ì¡", color:"orange"}, 22: {text:"í˜¼ì¡", color:"orange"} } 
            },
            { 
                name: "í™ëŒ€ ë¼ë©˜íŠ¸ëŸ­", category: "ë¼ë©˜", lat: 37.5570, lng: 126.9260, 
                tags: ["#ë§›ì§‘", "#ì›¨ì´íŒ…", "pub"], 
                img: "https://images.unsplash.com/photo-1569718212165-3a8278d5f624?q=80&w=400&h=400&auto=format&fit=crop", 
                address: "ë…ë§‰ë¡œ 15ê¸¸ 3", time: "11:00 - 21:00", desc: "ì°¨ìŠˆê°€ ì¼í’ˆì¸ ë¼ë©˜ì§‘", 
                menu: { "ë¼ë©˜": "10,000ì›", "ì°¨ìŠˆì¶”ê°€": "2,000ì›" }, 
                statusMap: { 12: {text:"í¬í™”", color:"red"}, 18: {text:"í¬í™”", color:"red"}, 22: {text:"ì˜ì—…ì¢…ë£Œ", color:"gray"} } 
            }
        ];

        var map = null;
        var markers = [];
        var routePolylines = [];
        var selectedHour = 18;
        var selectedDate = "11.26(ìˆ˜)";
        var currentFilter = 'all';

        let myKeywords = ["#ì¡°ìš©í•œ", "#ê°ì„±ì¹´í˜", "#ê°€ì„±ë¹„", "#ì›¨ì´íŒ…ì‹«ì–´", "#ë””ì €íŠ¸ë§›ì§‘", "#í˜¼ë°¥ê°€ëŠ¥"];
        const allKeywordDatabase = [
            "#ì¡°ìš©í•œ", "#ê°ì„±ì¹´í˜", "#ê°€ì„±ë¹„", "#ì›¨ì´íŒ…ì‹«ì–´", "#ë””ì €íŠ¸ë§›ì§‘", "#í˜¼ë°¥ê°€ëŠ¥",
            "#ë¶„ìœ„ê¸°ì¢‹ì€", "#ë°ì´íŠ¸ì½”ìŠ¤", "#ì•¼ê²½ë§›ì§‘", "#ë£¨í”„íƒ‘", "#ë°˜ë ¤ë™ë¬¼ë™ë°˜", 
            "#ë…¸íŠ¸ë¶í•˜ê¸°ì¢‹ì€", "#ì¹´ê³µ", "#ë„“ì€ë§¤ì¥", "#ì£¼ì°¨ê°€ëŠ¥", "#ì¹œì ˆí•œ", 
            "#í¬í† ì¡´", "#í™í•œ", "#ë ˆíŠ¸ë¡œ", "#ëª¨ë˜í•œ", "#í…Œë¼ìŠ¤", "#ë¸ŒëŸ°ì¹˜"
        ];

        const COLOR_MAP = { 
            blue: "#3b82f6", 
            green: "#22c55e", 
            orange: "#f97316", 
            red: "#ef4444", 
            gray: "#9ca3af" 
        };

        // [ìˆ˜ì •] í˜¼ì¡ë„ë³„ ì• ë‹ˆë©”ì´ì…˜ í¬ê¸° (Scale) ì •ì˜
        const PULSE_SCALES = {
            blue: 1.3,   // ì‘ê²Œ
            green: 1.7,  // ì¤‘ê°„
            orange: 2.1, // í¬ê²Œ
            red: 2.6     // ë§¤ìš° í¬ê²Œ
        };

        function initMap() {
            map = new naver.maps.Map('map', { center: new naver.maps.LatLng(37.557527, 126.9244669), zoom: 16, scaleControl: false, logoControl: false, mapDataControl: false, zoomControl: false });
            initCalendar();
            initTimeWheel();
            renderUI();
            renderTasteKeywords();
        }

        function renderTasteKeywords() {
            const container = document.getElementById('taste-keyword-container');
            let html = '';
            myKeywords.forEach(k => {
                const isHighlight = ["#ì¡°ìš©í•œ", "#ê°ì„±ì¹´í˜", "#ì›¨ì´íŒ…ì‹«ì–´"].includes(k);
                const cls = isHighlight ? "bg-status-green/10 text-status-green border-status-green/20 font-bold" : "bg-muted text-muted-foreground border-border";
                html += `<span class="px-3 py-1.5 border rounded-full text-xs ${cls}">${k}</span>`;
            });
            html += `<button onclick="openKeywordSearch()" class="px-3 py-1.5 bg-primary text-primary-foreground border border-transparent rounded-full text-xs font-bold shadow-sm hover:bg-primary/90 transition-colors flex items-center gap-1"><i class="fa-solid fa-plus"></i> í‚¤ì›Œë“œ ì¶”ê°€</button>`;
            container.innerHTML = html;
        }

        function openKeywordSearch() {
            openModal('keyword');
            document.getElementById('keyword-input').value = '';
            document.getElementById('keyword-input').focus();
            onKeywordInput('');
        }

        function onKeywordInput(val) {
            const container = document.getElementById('keyword-suggestions');
            let suggestions = [];
            if (!val) suggestions = allKeywordDatabase.filter(k => !myKeywords.includes(k)).slice(0, 5);
            else suggestions = allKeywordDatabase.filter(k => k.includes(val) && !myKeywords.includes(k));

            if (suggestions.length === 0) {
                container.innerHTML = `<div class="text-xs text-muted-foreground py-2 text-center">ì¶”ì²œ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }
            container.innerHTML = suggestions.map(k => `<div class="px-3 py-2 rounded-lg hover:bg-muted cursor-pointer text-sm text-foreground transition-colors flex justify-between items-center" onclick="addKeyword('${k}')"><span>${k}</span><i class="fa-solid fa-plus text-xs text-muted-foreground"></i></div>`).join('');
        }

        function addKeyword(keyword) {
            myKeywords.push(keyword);
            renderTasteKeywords();
            closeModal();
            showToast(`${keyword} í‚¤ì›Œë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        function initCalendar() {
            const grid = document.getElementById('calendar-grid');
            const days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
            let html = days.map(d => `<div class="text-muted-foreground">${d}</div>`).join('');
            for(let i=24; i<=30; i++) {
                let isToday = (i === 26);
                let cls = isToday ? "bg-primary text-primary-foreground rounded-full w-8 h-8 flex items-center justify-center font-bold mx-auto cursor-pointer" : "w-8 h-8 flex items-center justify-center mx-auto cursor-pointer hover:bg-muted rounded-full transition-colors";
                html += `<div class="${cls}" onclick="selectDate(this, ${i})">${i}</div>`;
            }
            grid.innerHTML = html;
        }

        function selectDate(el, day) {
            document.querySelectorAll('#calendar-grid div').forEach(d => { if(d.classList.contains('bg-primary')) d.className = "w-8 h-8 flex items-center justify-center mx-auto cursor-pointer hover:bg-muted rounded-full transition-colors"; });
            el.className = "bg-primary text-primary-foreground rounded-full w-8 h-8 flex items-center justify-center font-bold mx-auto cursor-pointer";
            selectedDate = `11.${day}(ìˆ˜)`;
        }

        function initTimeWheel() {
            const hourCol = document.getElementById('wheel-hour');
            let hHtml = '';
            for(let i=1; i<=12; i++) { let cls = (i === 6) ? 'selected' : ''; hHtml += `<div class="wheel-item ${cls}" data-val="${i}">${i}</div>`; }
            hourCol.innerHTML = hHtml;
            document.querySelectorAll('.wheel-col').forEach(col => {
                col.addEventListener('click', (e) => {
                    if(e.target.classList.contains('wheel-item')) {
                        Array.from(col.children).forEach(c => c.classList.remove('selected', 'text-primary', 'font-bold', 'text-lg'));
                        e.target.classList.add('selected');
                        col.scrollTo({ top: e.target.offsetTop - 64, behavior: 'smooth' });
                    }
                });
            });
        }

        function confirmDateTime() {
            const ampm = document.querySelector('#wheel-ampm .wheel-item.selected').dataset.val;
            let hour = parseInt(document.querySelector('#wheel-hour .wheel-item.selected').dataset.val);
            const min = document.querySelector('#wheel-minute .wheel-item.selected').dataset.val;
            const ampmText = ampm === 'AM' ? 'ì˜¤ì „' : 'ì˜¤í›„';
            document.getElementById('datetime-text').innerText = `${selectedDate} ${ampmText} ${hour}:${min}`;
            if (ampm === 'PM' && hour < 12) hour += 12;
            if (ampm === 'AM' && hour === 12) hour = 0;
            selectedHour = hour;
            closeModal();
            renderUI();
            showToast(`${selectedDate} ${ampmText} ${hour > 12 ? hour-12 : hour}:${min} ê¸°ì¤€ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.`);
        }

        function filterPlaces(category) {
            currentFilter = category;
            document.querySelectorAll('#filter-container button').forEach(btn => {
                const isActive = btn.getAttribute('onclick').includes(`'${category}'`);
                btn.className = isActive ? 'chip active px-3 py-1.5 bg-primary text-primary-foreground text-xs rounded-full border border-transparent shadow-sm whitespace-nowrap transition-all' : 'chip px-3 py-1.5 bg-background border border-border text-muted-foreground text-xs rounded-full shadow-sm whitespace-nowrap hover:bg-muted transition-all';
            });
            renderUI();
        }

        function getStatus(place) { return (place.statusMap && place.statusMap[selectedHour]) || {text:"ë³´í†µ", color:"green"}; }

        function renderUI() {
            markers.forEach(m => m.setMap(null));
            markers = [];
            const listContainer = document.getElementById('place-list');
            listContainer.innerHTML = '';
            const filteredData = placesData.filter(place => currentFilter === 'all' || place.tags.includes(currentFilter));
            
            filteredData.forEach((place, index) => {
                const statusInfo = getStatus(place);
                const hexColor = COLOR_MAP[statusInfo.color] || "#000";
                
                // [ìˆ˜ì •] ëª¨ë“  ë§ˆì»¤ì— í„ìŠ¤ ì ìš© & ìƒ‰ìƒë³„ í¬ê¸°(Scale) ì§€ì •
                const scale = PULSE_SCALES[statusInfo.color] || 1.5; // ê¸°ë³¸ê°’ 1.5
                
                // style="--pulse-scale: ${scale}" ë¥¼ ì£¼ì…í•˜ì—¬ CSS ì• ë‹ˆë©”ì´ì…˜ í¬ê¸° ì¡°ì ˆ
                const pulseHtml = `<div class="absolute w-full h-full rounded-full opacity-40 hot-pulse origin-center" style="background-color: ${hexColor}; --pulse-scale: ${scale};"></div>`;

                var markerContent = `
                    <div class="marker-content flex flex-col items-center cursor-pointer group" onclick="openDetail(${index})">
                        <div class="marker-bubble bg-white px-3 py-1.5 rounded-full shadow-lg text-xs font-bold text-slate-800 whitespace-nowrap mb-2 relative z-20 transition-transform group-hover:-translate-y-1 border border-gray-100">
                            ${place.name}
                            <div class="absolute left-1/2 bottom-[-6px] -translate-x-1/2 w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[6px] border-t-white"></div>
                        </div>
                        <div class="relative flex items-center justify-center w-10 h-10">
                            ${pulseHtml}
                            <div class="w-8 h-8 rounded-full shadow-md flex items-center justify-center border-2 border-white z-10" style="background-color: ${hexColor}">
                                <i class="fa-solid fa-location-dot text-white text-sm"></i>
                            </div>
                        </div>
                    </div>`;
                
                var marker = new naver.maps.Marker({ position: new naver.maps.LatLng(place.lat, place.lng), map: map, icon: { content: markerContent, size: new naver.maps.Size(100, 60), anchor: new naver.maps.Point(50, 60) }, zIndex: 100 });
                markers.push(marker);
                
                listContainer.innerHTML += `
                    <div class="place-card flex gap-4 p-5 border-b border-border cursor-pointer transition-colors hover:bg-muted/30 border-l-4" style="border-left-color: ${hexColor}" onclick="openDetail(${index})">
                        <img src="${place.img}" class="w-20 h-20 rounded-lg object-cover bg-muted border border-border shrink-0">
                        <div class="flex-1 flex flex-col justify-center min-w-0">
                            <div class="font-bold text-base text-foreground mb-1 truncate">${place.name} <span class="text-xs text-muted-foreground font-normal ml-1">${place.category}</span></div>
                            <div class="flex gap-1 flex-wrap mb-2">${place.tags.filter(t=>t.startsWith('#')).map(t => `<span class="px-1.5 py-0.5 bg-muted rounded text-[10px] text-muted-foreground">${t}</span>`).join('')}</div>
                            <div class="text-xs font-bold flex items-center gap-1.5" style="color: ${hexColor}"><i class="fa-solid fa-rss"></i> ${statusInfo.text}</div>
                        </div>
                    </div>`;
            });
        }

        function openDetail(index) {
            const place = placesData[index];
            const statusInfo = getStatus(place);
            const hexColor = COLOR_MAP[statusInfo.color];
            if(map) map.panTo(new naver.maps.LatLng(place.lat, place.lng));
            const modal = document.getElementById('detail-modal');
            const overlay = document.getElementById('modal-overlay');
            let menuHtml = place.menu ? Object.entries(place.menu).map(([m, p]) => `<div class="flex justify-between"><span class="font-medium">${m}</span><span class="text-muted-foreground">${p}</span></div>`).join('') : '';
            let recoHtml = placesData.filter(p => p.name !== place.name).map(p => `<div class="min-w-[120px] border border-border rounded-lg overflow-hidden cursor-pointer hover:shadow-md transition-shadow" onclick="showToast('ì¶”ì²œ ì¥ì†Œë¡œ ì´ë™í•©ë‹ˆë‹¤')"><img src="${p.img}" class="w-full h-20 object-cover bg-muted"><div class="p-2"><div class="font-bold text-xs text-foreground truncate mb-0.5">${p.name}</div><div class="text-[10px] text-muted-foreground">${p.category}</div></div></div>`).join('');
            modal.innerHTML = `<div class="relative h-44 shrink-0"><img src="${place.img}" class="w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div><button class="absolute top-4 right-4 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center hover:bg-black/50 transition-colors backdrop-blur-sm" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button><div class="absolute bottom-4 left-5 text-white"><h2 class="text-xl font-bold flex items-center gap-2">${place.name}<span class="text-xs px-2 py-0.5 rounded-full bg-white/20 backdrop-blur-md border border-white/30">${place.category}</span></h2></div></div><div class="p-5 overflow-y-auto"><div class="flex items-center justify-between mb-4"><span class="text-sm font-bold px-2.5 py-1 rounded bg-opacity-10" style="background-color: ${hexColor}20; color: ${hexColor}"><i class="fa-solid fa-rss mr-1"></i> í˜„ì¬ ${statusInfo.text}</span><span class="text-xs text-muted-foreground">â˜… 4.8 (120)</span></div><div class="space-y-2 text-sm text-muted-foreground mb-5"><div class="flex items-start gap-2"><i class="fa-solid fa-location-dot w-4 mt-0.5 text-center"></i> ${place.address}</div><div class="flex items-start gap-2"><i class="fa-regular fa-clock w-4 mt-0.5 text-center"></i> ${place.time}</div><div class="flex items-start gap-2"><i class="fa-solid fa-circle-info w-4 mt-0.5 text-center"></i> ${place.desc}</div><div class="flex items-start gap-2 text-foreground font-semibold mt-1"><i class="fa-solid fa-check-circle w-4 mt-0.5 text-center text-status-green"></i> í¬ìŠ¤ê¸° ì—°ë™: ì‹¤ì‹œê°„ ì˜ì—… ìƒíƒœ í™•ì¸ë¨</div></div><div class="bg-muted/30 p-4 rounded-xl border border-border mb-5"><div class="font-bold text-sm mb-2 text-foreground">ëŒ€í‘œ ë©”ë‰´</div><div class="space-y-1 text-xs text-foreground">${menuHtml}</div></div><div class="flex gap-3 mb-6"><button class="flex-1 py-3 border border-border rounded-lg font-bold text-sm text-foreground hover:bg-muted transition-colors" onclick="startNavigation(${place.lat}, ${place.lng})"><i class="fa-solid fa-location-arrow mr-1"></i> ê¸¸ì°¾ê¸°</button><button class="flex-1 py-3 bg-primary text-primary-foreground rounded-lg font-bold text-sm hover:bg-primary/90 transition-colors shadow-sm" onclick="openReservation()"><i class="fa-regular fa-calendar-check mr-1"></i> ì˜ˆì•½í•˜ê¸°</button></div><div class="pt-5 border-t border-border"><div class="font-bold text-sm mb-3 text-foreground">ì´ëŸ° ê³³ì€ ì–´ë•Œìš”?</div><div class="flex gap-3 overflow-x-auto scrollbar-hide pb-2">${recoHtml}</div></div></div>`;
            overlay.classList.remove('hidden');
            requestAnimationFrame(() => { overlay.classList.remove('opacity-0'); modal.classList.remove('hidden'); requestAnimationFrame(() => { modal.classList.remove('opacity-0', 'translate-y-[-40%]', 'scale-95'); }); });
        }

        function startNavigation(destLat, destLng) {
            closeModal();
            const myLat = 37.5575, myLng = 126.9225;

            // í™”ë©´ ì „í™˜
            document.getElementById('list-view').classList.add('hidden');
            document.getElementById('route-view').classList.remove('hidden');
            document.getElementById('route-view').classList.add('flex');

            // ê¸°ì¡´ ê²½ë¡œ ì‚­ì œ
            routePolylines.forEach(p => p.setMap(null));
            routePolylines = [];

            // ê²½ë¡œ ì„¤ì •
            const path1 = [new naver.maps.LatLng(myLat, myLng), new naver.maps.LatLng((myLat+destLat)/2, (myLng+destLng)/2), new naver.maps.LatLng(destLat, destLng)];
            const path2 = [new naver.maps.LatLng(myLat, myLng), new naver.maps.LatLng(myLat+0.002, myLng-0.001), new naver.maps.LatLng(destLat+0.001, destLng-0.001), new naver.maps.LatLng(destLat, destLng)];
            const path3 = [new naver.maps.LatLng(myLat, myLng), new naver.maps.LatLng(myLat-0.001, myLng+0.002), new naver.maps.LatLng(destLat-0.002, destLng+0.001), new naver.maps.LatLng(destLat, destLng)];

            // ê²½ë¡œ ê·¸ë¦¬ê¸°
            drawRoute(path1, '#4facfe', 0); // Blue
            drawRoute(path2, '#00c73c', 1); // Green
            drawRoute(path3, '#ff4d4d', 2); // Red

            highlightRoute(0);

            const bounds = new naver.maps.LatLngBounds();
            [...path1, ...path2, ...path3].forEach(p => bounds.extend(p));
            map.fitBounds(bounds, {top: 100, bottom: 300, left: 50, right: 50});

            showToast('3ê°€ì§€ ê²½ë¡œê°€ ê²€ìƒ‰ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function drawRoute(path, color, index) {
            const polyline = new naver.maps.Polyline({
                map: map, path: path, strokeColor: color, strokeWeight: 6, strokeOpacity: 0.5, strokeLineCap: 'round', strokeLineJoin: 'round', zIndex: 10
            });
            polyline.set('routeIndex', index);
            routePolylines.push(polyline);
        }

        function highlightRoute(index) {
            routePolylines.forEach((poly, i) => {
                if(i === index) {
                    poly.setOptions({strokeOpacity: 1, zIndex: 20, strokeWeight: 8});
                } else {
                    poly.setOptions({strokeOpacity: 0.3, zIndex: 10, strokeWeight: 6});
                }
            });
            document.querySelectorAll('.route-card').forEach((card, i) => {
                if(i === index) {
                    card.classList.add('bg-muted/30', 'ring-2', 'ring-offset-1', 'ring-primary/20');
                } else {
                    card.classList.remove('bg-muted/30', 'ring-2', 'ring-offset-1', 'ring-primary/20');
                }
            });
        }

        function stopNavigation() {
            routePolylines.forEach(p => p.setMap(null));
            routePolylines = [];
            document.getElementById('route-view').classList.add('hidden');
            document.getElementById('route-view').classList.remove('flex');
            document.getElementById('list-view').classList.remove('hidden');
            showToast('ê¸¸ì°¾ê¸°ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function openReservation() {
            closeModal();
            setTimeout(() => { openModal('reservation'); document.getElementById('res-date').valueAsDate = new Date(); }, 300);
        }
        function submitReservation() { closeModal(); showToast('ì˜ˆì•½ì´ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤! (ì•Œë¦¼í†¡ ë°œì†¡)'); }
        function switchTab(tabName, element) {
            const tabs = document.querySelectorAll('.tab-item');
            tabs.forEach(item => { item.classList.remove('active', 'text-primary', 'border-primary'); item.classList.add('text-muted-foreground', 'border-transparent'); });
            element.classList.add('active', 'text-primary', 'border-primary'); element.classList.remove('text-muted-foreground', 'border-transparent');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById('tab-' + tabName).classList.remove('hidden');
        }
        function openModal(modalId) {
            const modal = document.getElementById(modalId + '-modal'); const overlay = document.getElementById('modal-overlay');
            if(modal) { overlay.classList.remove('hidden'); requestAnimationFrame(() => { overlay.classList.remove('opacity-0'); modal.classList.remove('hidden'); requestAnimationFrame(() => { modal.classList.remove('opacity-0', 'translate-y-[-40%]', 'scale-95'); }); }); }
        }
        function closeModal() {
            const modals = document.querySelectorAll('.modal-window'); const overlay = document.getElementById('modal-overlay');
            modals.forEach(m => { if (!m.classList.contains('hidden')) { m.classList.add('opacity-0', 'translate-y-[-40%]', 'scale-95'); setTimeout(() => { m.classList.add('hidden'); }, 300); } });
            overlay.classList.add('opacity-0'); setTimeout(() => { overlay.classList.add('hidden'); }, 300);
        }
        function showToast(msg) {
            const toast = document.getElementById('toast'); toast.innerHTML = `<i class="fa-solid fa-circle-info mr-2"></i> ${msg}`;
            toast.classList.remove('opacity-0', 'translate-y-4'); setTimeout(() => { toast.classList.add('opacity-0', 'translate-y-4'); }, 2000);
        }
    </script>
</body>
</html>